{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":["file:///E:/my-geek-blog/src/lib/data.ts"],"sourcesContent":["// Define the Post type matches the API structure\nexport interface Post {\n    cid: number;\n    title: string;\n    text: string;\n    created: number; // Unix timestamp\n    author?: { screenName: string };\n    tag?: { name: string }[];\n    directory?: string;\n}\n\nexport interface ApiResponse<T> {\n    data: T;\n    total?: number;\n}\n\nconst API_BASE_URL = 'https://blog.tianiel.top/api';\n\nconst TOTAL_COUNT_CACHE_TAG = 'blog-total-count';\n\nasync function getTotalCount(): Promise<number> {\n    try {\n        // Fetch a large number to count total posts (Workaround for missing total header)\n        // Cached for 5 minutes\n        const res = await fetch(`${API_BASE_URL}/posts?page=1&pageSize=1000`, {\n            next: { revalidate: 300, tags: [TOTAL_COUNT_CACHE_TAG] }\n        });\n        if (!res.ok) return 0;\n        const data = await res.json();\n        return Array.isArray(data.data) ? data.data.length : 0;\n    } catch (e) {\n        console.error(\"Error fetching total count:\", e);\n        return 0;\n    }\n}\n\nexport async function getAllPosts(page = 1, pageSize = 10): Promise<{ posts: Post[], total: number }> {\n    try {\n        // Parallel fetch: posts for current page + total count (cached)\n        const [postsResponse, totalCount] = await Promise.all([\n            fetch(`${API_BASE_URL}/posts?page=${page}&pageSize=${pageSize}`, {\n                next: { revalidate: 60 }\n            }).then(r => r.json()),\n            getTotalCount()\n        ]);\n\n        // Parse posts from data.data\n        // Response structure is { status: 200, data: [...] } based on curl verification\n        const rawPosts = postsResponse.data || [];\n\n        let posts: Post[] = [];\n        if (Array.isArray(rawPosts)) {\n            posts = rawPosts.map((item: any) => ({\n                cid: Number(item.cid),\n                title: item.title,\n                text: item.text,\n                created: Number(item.created), // API returns explicit \"created\" timestamp string\n                author: item.author,\n                tag: item.tag,\n                directory: item.directory\n            }));\n        }\n\n        return {\n            posts,\n            total: totalCount || posts.length\n        };\n    } catch (error) {\n        console.error(\"Error fetching posts:\", error);\n        return { posts: [], total: 0 };\n    }\n}\n\nexport async function getPostById(id: string): Promise<Post | undefined> {\n    try {\n        const res = await fetch(`${API_BASE_URL}/post?cid=${id}`, {\n            next: { revalidate: 60 }\n        });\n\n        if (!res.ok) {\n            // API might return 404 or just null data\n            return undefined;\n        }\n\n        const data: ApiResponse<Post> = await res.json();\n\n        if (!data.data) return undefined;\n\n        // Ensure created is a number\n        return {\n            ...data.data,\n            created: Number(data.data.created)\n        };\n    } catch (error) {\n        console.error(`Error fetching post ${id}:`, error);\n        return undefined;\n    }\n}\n"],"names":[],"mappings":"AAAA,iDAAiD;;;;;;;AAgBjD,MAAM,eAAe;AAErB,MAAM,wBAAwB;AAE9B,eAAe;IACX,IAAI;QACA,kFAAkF;QAClF,uBAAuB;QACvB,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,2BAA2B,CAAC,EAAE;YAClE,MAAM;gBAAE,YAAY;gBAAK,MAAM;oBAAC;iBAAsB;YAAC;QAC3D;QACA,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;QACpB,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,OAAO,MAAM,OAAO,CAAC,KAAK,IAAI,IAAI,KAAK,IAAI,CAAC,MAAM,GAAG;IACzD,EAAE,OAAO,GAAG;QACR,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO;IACX;AACJ;AAEO,eAAe,YAAY,OAAO,CAAC,EAAE,WAAW,EAAE;IACrD,IAAI;QACA,gEAAgE;QAChE,MAAM,CAAC,eAAe,WAAW,GAAG,MAAM,QAAQ,GAAG,CAAC;YAClD,MAAM,GAAG,aAAa,YAAY,EAAE,KAAK,UAAU,EAAE,UAAU,EAAE;gBAC7D,MAAM;oBAAE,YAAY;gBAAG;YAC3B,GAAG,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI;YACnB;SACH;QAED,6BAA6B;QAC7B,gFAAgF;QAChF,MAAM,WAAW,cAAc,IAAI,IAAI,EAAE;QAEzC,IAAI,QAAgB,EAAE;QACtB,IAAI,MAAM,OAAO,CAAC,WAAW;YACzB,QAAQ,SAAS,GAAG,CAAC,CAAC,OAAc,CAAC;oBACjC,KAAK,OAAO,KAAK,GAAG;oBACpB,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;oBACf,SAAS,OAAO,KAAK,OAAO;oBAC5B,QAAQ,KAAK,MAAM;oBACnB,KAAK,KAAK,GAAG;oBACb,WAAW,KAAK,SAAS;gBAC7B,CAAC;QACL;QAEA,OAAO;YACH;YACA,OAAO,cAAc,MAAM,MAAM;QACrC;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO;YAAE,OAAO,EAAE;YAAE,OAAO;QAAE;IACjC;AACJ;AAEO,eAAe,YAAY,EAAU;IACxC,IAAI;QACA,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,UAAU,EAAE,IAAI,EAAE;YACtD,MAAM;gBAAE,YAAY;YAAG;QAC3B;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE;YACT,yCAAyC;YACzC,OAAO;QACX;QAEA,MAAM,OAA0B,MAAM,IAAI,IAAI;QAE9C,IAAI,CAAC,KAAK,IAAI,EAAE,OAAO;QAEvB,6BAA6B;QAC7B,OAAO;YACH,GAAG,KAAK,IAAI;YACZ,SAAS,OAAO,KAAK,IAAI,CAAC,OAAO;QACrC;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,CAAC,oBAAoB,EAAE,GAAG,CAAC,CAAC,EAAE;QAC5C,OAAO;IACX;AACJ"}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///E:/my-geek-blog/src/components/CommentsSection.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/CommentsSection.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/CommentsSection.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAsS,GACnU,oEACA","ignoreList":[0]}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///E:/my-geek-blog/src/components/CommentsSection.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/CommentsSection.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/CommentsSection.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAkR,GAC/S,gDACA","ignoreList":[0]}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///E:/my-geek-blog/src/components/PageTransition.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/PageTransition.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/PageTransition.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAqS,GAClU,mEACA","ignoreList":[0]}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///E:/my-geek-blog/src/components/PageTransition.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/PageTransition.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/PageTransition.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAiR,GAC9S,+CACA","ignoreList":[0]}},
    {"offset": {"line": 188, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file:///E:/my-geek-blog/src/components/MarkdownRender.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/MarkdownRender.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/MarkdownRender.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAqS,GAClU,mEACA","ignoreList":[0]}},
    {"offset": {"line": 210, "column": 0}, "map": {"version":3,"sources":["file:///E:/my-geek-blog/src/components/MarkdownRender.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/MarkdownRender.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/MarkdownRender.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAiR,GAC9S,+CACA","ignoreList":[0]}},
    {"offset": {"line": 224, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file:///E:/my-geek-blog/src/app/blog/%5Bid%5D/page.tsx"],"sourcesContent":["import { getPostById } from \"@/lib/data\";\nimport { notFound } from \"next/navigation\";\nimport Link from \"next/link\";\nimport Image from \"next/image\";\nimport { ArrowLeft, Calendar, Clock, User, FileText, Database } from \"lucide-react\";\nimport SiteHeader from \"@/components/SiteHeader\";\nimport CommentsSection from \"@/components/CommentsSection\";\nimport PageTransition from \"@/components/PageTransition\";\nimport MarkdownRender from \"@/components/MarkdownRender\";\n\nexport const dynamic = \"force-dynamic\";\n\nexport default async function BlogPostPage({\n    params,\n}: {\n    params: Promise<{ id: string }>;\n}) {\n    const { id } = await params;\n    const post = await getPostById(id);\n\n    if (!post) {\n        return notFound();\n    }\n\n    const isAdmin = false;\n\n    return (\n        <div className=\"min-h-screen bg-ak-bg text-gray-300 font-mono selection:bg-ak-cyan/30 selection:text-ak-cyan\">\n\n            <SiteHeader />\n\n            <main className=\"max-w-4xl mx-auto px-6 pt-32 pb-20 relative z-10\">\n\n                <PageTransition>\n\n                    {/* Navigation Bar */}\n                    <div className=\"flex items-center justify-between mb-12 border-b border-white/10 pb-4\">\n                         <Link href=\"/blog\" className=\"inline-flex items-center gap-2 text-gray-500 hover:text-ak-cyan transition-colors group text-sm tracking-widest uppercase\">\n                            <ArrowLeft size={16} className=\"group-hover:-translate-x-1 transition-transform\" />\n                            // Return to Archives\n                        </Link>\n                        <div className=\"text-xs text-ak-cyan tracking-[0.2em] animate-pulse\">\n                            SECURE CONNECTION ESTABLISHED\n                        </div>\n                    </div>\n\n                    <article className=\"relative\">\n                        {/* Decorative Background Elements */}\n                        <div className=\"absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-ak-cyan/10 to-transparent pointer-events-none opacity-50\" />\n                        <div className=\"absolute top-4 right-4 w-16 h-1 border-t border-r border-ak-cyan/50 rounded-tr-xl\" />\n\n                        <header className=\"mb-16 relative\">\n                            <div className=\"inline-block bg-ak-yellow text-black text-xs font-bold px-2 py-1 mb-6 tracking-widest uppercase\">\n                                Confidential // Level 3\n                            </div>\n\n                            <h1 className=\"text-3xl md:text-5xl font-black text-white leading-tight mb-8 tracking-tight\">\n                                {post.title}\n                            </h1>\n\n                            {/* Metadata Grid */}\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 border-y border-white/10 py-6 bg-white/5 backdrop-blur-sm\">\n                                <div className=\"flex items-center gap-3 px-4 border-r border-white/5 last:border-0\">\n                                    <div className=\"p-2 bg-white/5 rounded-full text-ak-cyan\">\n                                        <Calendar size={14} />\n                                    </div>\n                                    <div className=\"flex flex-col\">\n                                        <span className=\"text-[10px] text-gray-500 uppercase tracking-wider\">Date</span>\n                                        <span className=\"text-xs font-bold text-white\">{new Date(post.created * 1000).toLocaleDateString('zh-CN')}</span>\n                                    </div>\n                                </div>\n                                \n                                <div className=\"flex items-center gap-3 px-4 border-r border-white/5 last:border-0\">\n                                    <div className=\"p-2 bg-white/5 rounded-full text-ak-cyan\">\n                                        <Clock size={14} />\n                                    </div>\n                                    <div className=\"flex flex-col\">\n                                        <span className=\"text-[10px] text-gray-500 uppercase tracking-wider\">Time</span>\n                                        <span className=\"text-xs font-bold text-white\">{new Date(post.created * 1000).toLocaleTimeString('zh-CN')}</span>\n                                    </div>\n                                </div>\n\n                                <div className=\"flex items-center gap-3 px-4 border-r border-white/5 last:border-0\">\n                                    <div className=\"p-2 bg-white/5 rounded-full text-ak-cyan\">\n                                        <FileText size={14} />\n                                    </div>\n                                    <div className=\"flex flex-col\">\n                                        <span className=\"text-[10px] text-gray-500 uppercase tracking-wider\">Category</span>\n                                        <span className=\"text-xs font-bold text-ak-yellow uppercase\">{post.directory || 'System'}</span>\n                                    </div>\n                                </div>\n\n                                <div className=\"flex items-center gap-3 px-4\">\n                                    <div className=\"relative w-8 h-8 rounded-full overflow-hidden border border-ak-cyan/50\">\n                                        <Image\n                                            src=\"/avatar.png\"\n                                            alt=\"Leander\"\n                                            fill\n                                            className=\"object-cover\"\n                                        />\n                                    </div>\n                                    <div className=\"flex flex-col\">\n                                        <span className=\"text-[10px] text-gray-500 uppercase tracking-wider\">Operator</span>\n                                        <span className=\"text-xs font-bold text-white\">{post.author?.screenName || 'Leander'}</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </header>\n\n                        <div className=\"mb-20 p-1 md:p-8 border border-white/5 bg-[#0a0a0a] relative overflow-hidden rounded-sm\">\n                             {/* Scanline Effect (Optional, kept subtle) */}\n                             <div className=\"absolute inset-0 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] z-[1] bg-[length:100%_4px,3px_100%] pointer-events-none opacity-20\" />\n                            \n                             <div className=\"relative z-10\">\n                                <MarkdownRender content={post.text} />\n                             </div>\n                        </div>\n                    </article>\n\n                    <CommentsSection postId={post.cid.toString()} isAdmin={isAdmin} />\n\n                </PageTransition>\n\n            </main>\n        </div>\n    );\n}\r\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;AAEO,MAAM,UAAU;AAER,eAAe,aAAa,EACvC,MAAM,EAGT;IACG,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,MAAM,OAAO,MAAM,IAAA,iIAAW,EAAC;IAE/B,IAAI,CAAC,MAAM;QACP,OAAO,IAAA,iMAAQ;IACnB;IAEA,MAAM,UAAU;IAEhB,qBACI,8OAAC;QAAI,WAAU;;0BAEX,8OAAC,2IAAU;;;;;0BAEX,8OAAC;gBAAK,WAAU;0BAEZ,cAAA,8OAAC,+IAAc;;sCAGX,8OAAC;4BAAI,WAAU;;8CACV,8OAAC,0LAAI;oCAAC,MAAK;oCAAQ,WAAU;;sDAC1B,8OAAC,6NAAS;4CAAC,MAAM;4CAAI,WAAU;;;;;;wCAAoD;;;;;;;8CAGvF,8OAAC;oCAAI,WAAU;8CAAsD;;;;;;;;;;;;sCAKzE,8OAAC;4BAAQ,WAAU;;8CAEf,8OAAC;oCAAI,WAAU;;;;;;8CACf,8OAAC;oCAAI,WAAU;;;;;;8CAEf,8OAAC;oCAAO,WAAU;;sDACd,8OAAC;4CAAI,WAAU;sDAAkG;;;;;;sDAIjH,8OAAC;4CAAG,WAAU;sDACT,KAAK,KAAK;;;;;;sDAIf,8OAAC;4CAAI,WAAU;;8DACX,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;4DAAI,WAAU;sEACX,cAAA,8OAAC,sNAAQ;gEAAC,MAAM;;;;;;;;;;;sEAEpB,8OAAC;4DAAI,WAAU;;8EACX,8OAAC;oEAAK,WAAU;8EAAqD;;;;;;8EACrE,8OAAC;oEAAK,WAAU;8EAAgC,IAAI,KAAK,KAAK,OAAO,GAAG,MAAM,kBAAkB,CAAC;;;;;;;;;;;;;;;;;;8DAIzG,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;4DAAI,WAAU;sEACX,cAAA,8OAAC,6MAAK;gEAAC,MAAM;;;;;;;;;;;sEAEjB,8OAAC;4DAAI,WAAU;;8EACX,8OAAC;oEAAK,WAAU;8EAAqD;;;;;;8EACrE,8OAAC;oEAAK,WAAU;8EAAgC,IAAI,KAAK,KAAK,OAAO,GAAG,MAAM,kBAAkB,CAAC;;;;;;;;;;;;;;;;;;8DAIzG,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;4DAAI,WAAU;sEACX,cAAA,8OAAC,0NAAQ;gEAAC,MAAM;;;;;;;;;;;sEAEpB,8OAAC;4DAAI,WAAU;;8EACX,8OAAC;oEAAK,WAAU;8EAAqD;;;;;;8EACrE,8OAAC;oEAAK,WAAU;8EAA8C,KAAK,SAAS,IAAI;;;;;;;;;;;;;;;;;;8DAIxF,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;4DAAI,WAAU;sEACX,cAAA,8OAAC,wIAAK;gEACF,KAAI;gEACJ,KAAI;gEACJ,IAAI;gEACJ,WAAU;;;;;;;;;;;sEAGlB,8OAAC;4DAAI,WAAU;;8EACX,8OAAC;oEAAK,WAAU;8EAAqD;;;;;;8EACrE,8OAAC;oEAAK,WAAU;8EAAgC,KAAK,MAAM,EAAE,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8CAM3F,8OAAC;oCAAI,WAAU;;sDAEV,8OAAC;4CAAI,WAAU;;;;;;sDAEf,8OAAC;4CAAI,WAAU;sDACZ,cAAA,8OAAC,+IAAc;gDAAC,SAAS,KAAK,IAAI;;;;;;;;;;;;;;;;;;;;;;;sCAK9C,8OAAC,gJAAe;4BAAC,QAAQ,KAAK,GAAG,CAAC,QAAQ;4BAAI,SAAS;;;;;;;;;;;;;;;;;;;;;;;AAO3E"}}]
}